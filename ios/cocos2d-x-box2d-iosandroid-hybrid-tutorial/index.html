<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Cocos2d-x Box2D iOS/Android Hybrid Tutorial</title>
    <meta name="description" content="Alex Swan is a full stack developer currently working at NBCUniversal.  He also makes mobile and console games and has a hamster.
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link rel="canonical" href="http://www.bold-it.com/ios/cocos2d-x-box2d-iosandroid-hybrid-tutorial/">

    <script type="text/javascript" src="//static.twilio.com/libs/twiliojs/1.2/twilio.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Node.js, PHP and Python Programming Examples by Alex Swan</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
        
          
        
          
          <a class="page-link" href="/games-by-alex-swan/index.html">Games by Alex Swan</a>
          
        
          
          <a class="page-link" href="/voicemail/index.html">Voicemail</a>
          
        
          
          <a class="page-link" href="/about/index.html">About</a>
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Cocos2d-x Box2D iOS/Android Hybrid Tutorial</h1>
    <p class="post-meta">Sep 23, 2012 â€¢ alex</p>
  </header>

  <article class="post-content">
    <p>How to start a Cocos2d-X project designed for both iPhone/iPad and Android</p>
<p>The Cocos2d-x project is always updating, so the latest tutorials on setting up a hybrid work environment aren't completely accurate.<br />
<br /></p>
<h3>Versions for this tutorial:</h3>
<p>
Cocos2d-x: <a href="http://cocos2d-x.googlecode.com/files/cocos2d-2.0-x-2.0.2.zip">cocos2d-2.0-x-2.0.2 @ Aug 30 2012</a><br /><br />
XCode: v4.5<br /><br />
Android NDK: <a href="http://dl.google.com/android/ndk/android-ndk-r8b-darwin-x86.tar.bz2">Android NDK, Revision 8b (July 2012)</a><br /></p>
<p>Here's the basic outline:</p>
<ol>
<li>Install Cocos2d-x</li>
<li>Install the XCode templates</li>
<li>Create an iPhone project</li>
<li>Create an Android project</li>
<li>Move the necessary Android files</li>
<li>Change the Android files to fit the new location</li>
</ol>
<h2>Install Cocos2d-x</h2>
<p>Download <a href="http://cocos2d-x.googlecode.com/files/cocos2d-2.0-x-2.0.2.zip">cocos2d-2.0-x-2.0.2 @ Aug 30 2012</a> and unzip it somewhere, such as your home directory.</p>
<h2>Install the XCode templates</h2>
<p>In the Terminal, go to the Cocos2d-x directory, then type:</p>
<p>[code lang="shell"]<br />
./install-templates-xcode.sh<br />
</p>
<p>This will give you a few options in the XCode New Project window.</p>
<h2>Create an iPhone project</h2>
<p>In XCode, click File-&gt;New-&gt;Project, create a new cocos2dx_box2d project, and name it anything (for example, 'testgame').</p>
<p><a href="/medialibrary/Screen-Shot-2012-09-23-at-12.15.26-AM.png"><img class="alignnone  wp-image-280" title="Screen Shot 2012-09-23 at 12.15.26 AM" src="/medialibrary/Screen-Shot-2012-09-23-at-12.15.26-AM.png" alt="" width="618" height="427" /></a><br /></p>
<p>This will create a test game using Cocos2d-x and Box2D. Test it to make sure it runs on your system.</p>
<h2>Create an Android project</h2>
<p>First you need to set some environment variables.  In create-android-project.sh, edit the following lines near the top:</p>
<p>
<pre><code><br />
# set environment paramters<br />
NDK_ROOT_LOCAL=&quot;/Users/alex/android-ndk-r8b&quot;<br />
ANDROID_SDK_ROOT_LOCAL=&quot;/Users/alex/android-sdk-macosx&quot;<br />
</code></pre></p>
<p>Point them to your own NDK and Android SDK paths.<br /><br />
If you want to keep an NDK_ROOT environment variable:<br />
<pre><code><br />
export NDK_ROOT=/Users/alex/android-ndk-r8b<br />
</code></pre><br />
Next, create an android project.  In Terminal, in the same directory as before:<br />
<pre><code><br />
./create-android-project.sh --box2d<br />
</code></pre><br />
The --box2d parameter makes sure to include the Box2D library.<br />
You will be asked three questions:<br />
Identify your project<br />
<pre><code><br />
Input package path. For example: org.cocos2dx.example<br />
com.boldit.testgame<br />
</code></pre></p>
<p>Choose what Android version you want. It will list what SDKs are available on your system. If you don't have any, <a href="http://developer.android.com/sdk/installing/index.html" target="_blank">install one</a>.</p>
<p>
<pre><code><br />
Now cocos2d-x supports Android 2.2 or upper version<br />
Available Android targets:<br />
...<br />
----------<br />
id: 7 or &quot;Google Inc.:Google APIs:10&quot;<br />
     Name: Google APIs<br />
     Type: Add-On<br />
     Vendor: Google Inc.<br />
     Revision: 2<br />
     Description: Android + Google APIs<br />
     Based on Android 2.3.3 (API level 10)<br />
     Libraries:<br />
      * com.android.future.usb.accessory (usb.jar)<br />
          API for USB Accessories<br />
      * com.google.android.maps (maps.jar)<br />
          API for Google Maps<br />
     Skins: WVGA854, WQVGA400, HVGA, WQVGA432, WVGA800 (default), QVGA<br />
     ABIs : armeabi<br />
----------<br />
...<br />
input target id:<br />
7<br />
</code></pre></p>
<p>Last, give a name/directory for your project.</p>
<p><pre><code><br />
input your project name:<br />
testgame<br />
</code></pre></p>
<p>Now, test this to make sure it compiles<br />
<pre><code><br />
cd testgame<br />
./build_native.sh<br />
</code></pre></p>
<h2>Move the necessary Android files</h2>
<p>The XCode template only copied enough over for iOS devices.  We are going to include the Android files as well.</p>
<ul>
<li>Move the <strong>&lt;COCOS2DX_ROOT&gt;/testgame/proj.android</strong> folder to the iphone project folder, next to ios.  Rename it android.</li>
<li>Copy the <strong>&lt;COCOS2DX_ROOT&gt;/external/Box2D</strong> folder into <strong>&lt;IPHONE_PROJECT&gt;/libs/</strong>, replace what is there.</li>
<li>Copy the <strong>&lt;COCOS2DX_ROOT&gt;/cocos2dx</strong> folder into <strong>&lt;IPHONE_PROJECT&gt;/libs/</strong>, replace what is there.</li>
<li>Copy the <strong>&lt;COCOS2DX_ROOT&gt;/CocosDenshion/android</strong> folder into <strong>&lt;IPHONE_PROJECT&gt;/libs/CocosDenshion/</strong></li>
<li>Copy the <strong>&lt;COCOS2DX_ROOT&gt;/extensions</strong> folder to <strong>&lt;IPHONE_PROJECT&gt;/libs/</strong>, replace what is there.</li>
</ul>
<h2>Change the Android files to fit the new location</h2>
<p>We moved the relative location of the cocos2dx folder for the Android project.  Instead of going two directories back, the cocos2dx folder is now one directory back and in the libs folder.  In &lt;IPHONE_PROJECT&gt;/android/build_native.sh, change line 40:</p>
<p>[code title="build_native.sh"]<br />
COCOS2DX_ROOT=&quot;$DIR/../libs&quot;<br />
</p>
<p>And update the LOCAL_C_INCLUDES on line 13 to include Box2D:</p>
<p><pre><code><br />
LOCAL_C_INCLUDES := $(LOCAL_PATH)/../../Classes<br />
                   $(LOCAL_PATH)/../../libs/Box2d<br />
</code></pre></p>
<p>Next, in android/jni/Android.mk, add a LOCAL_C_INCLUDES path to Box2D and change "$(call import-module,external/Box2D)" to "$(call import-module,Box2D)".  The result should look like this:<br />
<script src="https://gist.github.com/3772441.js"> </script></p>
<h2>Test and run</h2>
<p>Everything should be set up!  Build the project from XCode to test iOS.  Use these commands to build for android from the command line (in the new android directory)</p>
<p><pre><code><br />
./build_native.sh clean<br />
./build_native.sh<br />
ant debug<br />
adb install -r bin/testgame-debug.apk<br />
adb shell am start -a android.intent.action.MAIN -n com.boldit.testgame/.testgame<br />
</code></pre></p>
<p>The first two commands clean and build the cpp into java.  The `ant` command <a href="http://developer.android.com/tools/building/building-cmdline.html" target="_blank">builds</a> a debug apk for us.  The last two commands install and run the apk, respectively.</p>
<h2>FAQ</h2>
<p>This error:<br />
<pre><code><br />
Android NDK: /Users/alex/testgame/testgame/android/../libs/cocos2dx/platform/third_party/android/prebuilt/libcurl/Android.mk: Cannot find module with tag 'Box2D' in import path<br />
Android NDK: Are you sure your NDK_MODULE_PATH variable is properly defined ?<br />
</code></pre><br />
was caused because Box2D was not completely configured.</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Node.js, PHP and Python Programming Examples by Alex Swan</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Node.js, PHP and Python Programming Examples by Alex Swan</li>
          <li><a href="mailto:contact@bold-it.com">contact@bold-it.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/BoldBigflank">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">BoldBigflank</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/BoldBigflank">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">BoldBigflank</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Alex Swan is a full stack developer currently working at NBCUniversal.  He also makes mobile and console games and has a hamster.
</p>
      </div>
    </div>

  </div>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-26966562-1', 'auto');
    ga('send', 'pageview');

  </script>
</footer>


  </body>

</html>
